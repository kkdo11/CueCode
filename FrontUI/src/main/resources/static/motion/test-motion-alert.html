<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test Motion Alert</title>
</head>
<body>

<h1>Test Dangerous Phrase Alerts</h1>

<button onclick="getAlerts()">Get Alerts for Logged-in User</button>

<h2>Results:</h2>
<pre id="results"></pre>

<script>
    // 1. HttpOnly 쿠키는 JS로 읽을 수 없으므로 getCookie 함수는 삭제합니다.

    function getAlerts() {
        const resultsContainer = document.getElementById('results');
        resultsContainer.textContent = 'Loading...';

        const url = `http://localhost:13000/api/motions/alerts`;

        // 2. 수동으로 Authorization 헤더를 만드는 로직을 모두 삭제합니다.
        //    브라우저가 'credentials: include' 옵션에 따라 자동으로 처리합니다.
        fetch(url, {
            method: 'GET',
            credentials: 'include' // <-- 이 옵션 하나로 충분합니다!
        })
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                resultsContainer.textContent = JSON.stringify(data, null, 2);
            })
            .catch(error => {
                resultsContainer.textContent = `Error: ${error.message}\n\nCheck the browser console for more details.`;
                console.error('Error fetching alerts:', error);
            });
    }
</script>

</body>
</html>